import{r as v,c,o as r,d as b,f as o,g as u,a as h,h as S,v as g,F as p,i as x,n as d,j as f,t as m}from"./app-TAoPpn_3.js";import{_ as z}from"./plugin-vue_export-helper-DlAUqK2U.js";const y={data(){return{rainbowColors:["red","orange","yellow","green","blue","indigo","violet"],canvas:null,ctx:null,colorIndex:null,drawing:!1,progress:5,circleSize:5,angle:1e3,colorType:"setting",selectedColor:"#aaaaaa",colorValue:"#aaaaaa",options:[{label:"彩虹色",value:"rainbow"},{label:"自设",value:"setting"}],shape:"circle",shapeOptions:[{label:"圆形",value:"circle"},{label:"矩形",value:"rectangle"},{label:"三角形",value:"triangle"},{label:"星形",value:"star"}]}},mounted(){this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),this.resizeCanvas(),window.addEventListener("resize",this.resizeCanvas),this.drawing=!1,this.canvas.addEventListener("touchstart",i=>{i.preventDefault(),this.drawing=!0}),this.canvas.addEventListener("touchend",i=>{i.preventDefault(),this.drawing=!1}),this.canvas.addEventListener("touchmove",i=>{i.preventDefault(),this.draw(i)}),this.canvas.addEventListener("mousedown",()=>this.drawing=!0),this.canvas.addEventListener("mouseup",()=>this.drawing=!1),this.canvas.addEventListener("mouseleave",()=>this.drawing=!1),this.canvas.addEventListener("mousemove",this.draw)},beforeDestroy(){window.removeEventListener("resize",this.resizeCanvas)},methods:{resizeCanvas(){const t=this.$refs.container.getBoundingClientRect();this.canvas.width=t.width,this.canvas.height=t.height},draw(i){if(!this.drawing)return;const t=this.canvas.getBoundingClientRect();let s,n;i.touches?(s=i.touches[0].clientX-t.left,n=i.touches[0].clientY-t.top):(s=i.clientX-t.left,n=i.clientY-t.top),this.colorIndex||(this.colorIndex=0),this.colorType=="rainbow"?(this.ctx.fillStyle=this.rainbowColors[this.colorIndex],this.colorIndex=(this.colorIndex+1)%this.rainbowColors.length):this.ctx.fillStyle=this.colorValue,this.ctx.beginPath();let e=this.circleSize/2;this.shape=="circle"?(this.ctx.arc(s,n,this.circleSize/2,0,2*Math.PI*this.angle/1e3),this.ctx.fill()):this.shape=="rectangle"?this.ctx.fillRect(s-e,n-e,this.circleSize,this.circleSize):this.shape=="triangle"?(this.ctx.beginPath(),this.ctx.moveTo(s-.577*this.circleSize,n+e),this.ctx.lineTo(s,n-2*this.circleSize/3),this.ctx.lineTo(s+.577*this.circleSize,n+e),this.ctx.closePath()):this.shape=="star"&&(this.ctx.beginPath(),this.ctx.moveTo(s,n+2*e/2),this.ctx.lineTo(s+.577*e/2,n+e/2),this.ctx.lineTo(s+1.732*e/2,n+e/2),this.ctx.lineTo(s+1.154*e/2,n),this.ctx.lineTo(s+1.732*e/2,n-e/2),this.ctx.lineTo(s+.577*e/2,n-e/2),this.ctx.lineTo(s,n-2*e/2),this.ctx.lineTo(s-.577*e/2,n-e/2),this.ctx.lineTo(s-1.732*e/2,n-e/2),this.ctx.lineTo(s-1.154*e/2,n),this.ctx.lineTo(s-1.732*e/2,n+e/2),this.ctx.lineTo(s-.577*e/2,n+e/2),this.ctx.closePath()),this.ctx.fill()},clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},saveCanvas(){const{canvas:i}=this.$refs;i.toBlob(t=>{const s=document.createElement("a");s.download=`canvas_${Date.now()}.png`,s.href=window.URL.createObjectURL(t),s.click(),console.log(t)},"image/png")},uploadCanvasToOss(){},handleProgressChange(){this.circleSize=10+this.progress/100*90},handleAngleChange(){this.angle=this.angle},getChildData(i){this.colorValue=i},checkShape(i){return i==this.shape}}},k={ref:"container",class:"canvas-container"},T=["value"],V=["value"],L={class:"pen-size"},E={key:0},P={style:{display:"flex"}},I={ref:"canvas",class:"flex-canvas"};function D(i,t,s,n,e,a){const w=v("ColorPicker"),C=v("star");return r(),c("div",k,[b(w,{modelValue:e.colorValue,"onUpdate:modelValue":t[0]||(t[0]=l=>e.colorValue=l),"onUpdate:color":a.getChildData},null,8,["modelValue","onUpdate:color"]),t[10]||(t[10]=o("span",null,"颜色:",-1)),u(o("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>e.colorType=l)},[(r(!0),c(p,null,x(e.options,l=>(r(),c("option",{key:l.value,value:l.value},m(l.label),9,T))),128))],512),[[g,e.colorType]]),t[11]||(t[11]=o("span",null,"画笔:",-1)),u(o("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>e.shape=l)},[(r(!0),c(p,null,x(e.shapeOptions,l=>(r(),c("option",{key:l.value,value:l.value},m(l.label),9,V))),128))],512),[[g,e.shape]]),a.checkShape("circle")?(r(),c("div",{key:0,class:"circle",style:d({width:e.circleSize+"px",height:e.circleSize+"px",backgroundColor:e.colorValue})},null,4)):h("",!0),a.checkShape("rectangle")?(r(),c("div",{key:1,class:"rectangle",style:d({width:e.circleSize+"px",height:e.circleSize+"px",backgroundColor:e.colorValue})},null,4)):h("",!0),a.checkShape("triangle")?(r(),c("div",{key:2,class:"triangle",style:d({"border-left-width":e.circleSize/2+"px","border-right-width":e.circleSize/2+"px","border-bottom-width":e.circleSize+"px","border-bottom-color":e.colorValue})},null,4)):h("",!0),a.checkShape("star")?(r(),S(C,{key:3,color:e.colorValue,size:e.circleSize},null,8,["color","size"])):h("",!0),o("div",L,[t[9]||(t[9]=o("span",null,"大小",-1)),u(o("input",{type:"range",min:"0",max:"100","onUpdate:modelValue":t[3]||(t[3]=l=>e.progress=l),onInput:t[4]||(t[4]=(...l)=>a.handleProgressChange&&a.handleProgressChange(...l)),class:"progress-bar"},null,544),[[f,e.progress]]),a.checkShape("circle")?(r(),c("span",E,"角度")):h("",!0),a.checkShape("circle")?u((r(),c("input",{key:1,type:"range","onUpdate:modelValue":t[5]||(t[5]=l=>e.angle=l),min:"0",max:"1000",onInput:t[6]||(t[6]=(...l)=>a.handleAngleChange&&a.handleAngleChange(...l))},null,544)),[[f,e.angle]]):h("",!0)]),o("div",P,[o("button",{onClick:t[7]||(t[7]=(...l)=>a.clear&&a.clear(...l))},"清除"),o("button",{onClick:t[8]||(t[8]=(...l)=>a.saveCanvas&&a.saveCanvas(...l))},"导出")]),o("canvas",I,null,512)],512)}const R=z(y,[["render",D],["__scopeId","data-v-1c011b63"]]);export{R as default};
