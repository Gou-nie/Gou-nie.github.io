import{M as S,S as F,C as N,P as j,W as G,A as T,D as V,R as I,V as Y,B as W,a as C,b as B}from"./three.module-DVEct7hv.js";import{O as q}from"./OrbitControls-DwG8HtnJ.js";import{g as U}from"./index-CH_iu5NA.js";import{l as _,q as X,s as Z,c as L,o as z,f as Q,a as J}from"./app-C8W_prMo.js";const K={class:"bookshelf-container"},$={key:0,class:"loading-overlay"},ae={__name:"RandomShelf",setup(ee){const o=_(null),g=_(!0);let r,c,l,h,u,m,a,f=[];const s={width:5,height:.1,depth:1,levels:3,levelHeight:1.5,material:new S({color:9127187})},n={minWidth:.2,maxWidth:.4,minHeight:.8,maxHeight:1.2,depth:.8,colors:[16711680,65280,255,16776960,16711935,65535,8421504,11119017,32768,8388736],highlightEmissive:5592320},v=[{url:"https://www.google.com",title:"Google Book"},{url:"https://www.wikipedia.org",title:"Wiki Book"},{url:"https://developer.mozilla.org",title:"MDN Book"},{url:"https://threejs.org",title:"Three.js Docs"},{url:"https://vuejs.org",title:"Vue.js Docs"},{url:"https://github.com",title:"GitHub Projects"},{url:"https://stackoverflow.com",title:"StackOverflow Q&A"},{url:"https://news.ycombinator.com",title:"Hacker News"},{url:"https://www.amazon.com",title:"Amazon Shopping"},{url:"https://www.nytimes.com",title:"NY Times"},{url:"https://www.bbc.com/news",title:"BBC News"}];function M(){if(!o.value)return;g.value=!0,r=new F,r.background=new N(15790320),c=new j(75,window.innerWidth/window.innerHeight,.1,1e3),c.position.set(0,s.levelHeight*1.5,5),l=new G({canvas:o.value,antialias:!0}),l.setSize(window.innerWidth,window.innerHeight),l.setPixelRatio(window.devicePixelRatio),l.shadowMap.enabled=!0;const t=new T(16777215,.6);r.add(t);const e=new V(16777215,.8);e.position.set(5,10,7.5),e.castShadow=!0,e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024,r.add(e),h=new q(c,l.domElement),h.enableDamping=!0,h.target.set(0,s.levelHeight,0),u=new I,m=new Y,P(),R(),window.addEventListener("resize",p),o.value.addEventListener("mousemove",x),o.value.addEventListener("click",k),g.value=!1,H()}function P(){const t=new W(s.width,s.height,s.depth);for(let e=0;e<s.levels;e++){const i=new C(t,s.material);i.position.y=e*s.levelHeight,i.receiveShadow=!0,r.add(i)}}function R(){let t=0;for(let e=0;e<s.levels;e++){let i=-2.5+n.maxWidth/2+.1;const w=e*s.levelHeight+s.height/2;for(let y=0;y<5&&t<v.length&&!(i+n.maxWidth/2>s.width/2);y++){const D=B.randFloat(n.minHeight,n.maxHeight),E=B.randFloat(n.minWidth,n.maxWidth*.8),A=new W(E,D,n.depth),O=new S({color:n.colors[t%n.colors.length],roughness:.7,metalness:.1}),d=new C(A,O);d.position.set(i,w+D/2,0),d.castShadow=!0,d.userData={url:v[t].url,title:v[t].title,originalPositionZ:d.position.z,originalEmissive:d.material.emissive.getHex(),isPulledOut:!1},r.add(d),f.push(d),i+=E+.05,t++}}}function p(){c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix(),l.setSize(window.innerWidth,window.innerHeight)}function x(t){if(!o.value)return;const e=o.value.getBoundingClientRect();m.x=(t.clientX-e.left)/e.width*2-1,m.y=-((t.clientY-e.top)/e.height)*2+1,u.setFromCamera(m,c);const i=u.intersectObjects(f);if(i.length>0){const w=i[0].object;a!==w&&(a&&a.material.emissive.setHex(a.userData.originalEmissive),a=w,a.material.emissive.setHex(n.highlightEmissive),o.value.style.cursor="pointer")}else a&&a.material.emissive.setHex(a.userData.originalEmissive),a=null,o.value.style.cursor="default"}function k(t){if(!o.value)return;u.setFromCamera(m,c);const e=u.intersectObjects(f);if(e.length>0){const i=e[0].object;if(i.userData.isPulledOut)return;i.userData.isPulledOut=!0,U.to(i.position,{z:i.userData.originalPositionZ+n.depth/2,duration:.5,ease:"power2.out",onComplete:()=>{i.userData.url&&window.open(i.userData.url,"_blank")}})}}let b;function H(){b=requestAnimationFrame(H),h.update(),l.render(r,c)}return X(()=>{M()}),Z(()=>{cancelAnimationFrame(b),window.removeEventListener("resize",p),o.value&&(o.value.removeEventListener("mousemove",x),o.value.removeEventListener("click",k)),l&&l.dispose(),r&&r.traverse(t=>{t.geometry&&t.geometry.dispose(),t.material&&(Array.isArray(t.material)?t.material.forEach(e=>e.dispose()):t.material.dispose())}),h&&h.dispose(),f=[],a=null}),(t,e)=>(z(),L("div",K,[Q("canvas",{ref_key:"canvasRef",ref:o},null,512),g.value?(z(),L("div",$,"Loading 3D Scene...")):J("",!0)]))}};export{ae as default};
