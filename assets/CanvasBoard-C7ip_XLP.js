import S from"./star-CVw2IFwp.js";import b from"./ColorPicker-W7fmG_I-.js";import{r as v,c,o as a,d as k,f as o,g as u,a as h,h as z,i as g,F as p,j as x,n as d,v as f,t as m}from"./app-CFVp5HSX.js";import{_ as y}from"./plugin-vue_export-helper-DlAUqK2U.js";const T={components:{Star:S,ColorPicker:b},data(){return{rainbowColors:["red","orange","yellow","green","blue","indigo","violet"],canvas:null,ctx:null,colorIndex:null,drawing:!1,progress:5,circleSize:5,angle:1e3,colorType:"setting",selectedColor:"#aaaaaa",colorValue:"#aaaaaa",options:[{label:"彩虹色",value:"rainbow"},{label:"自设",value:"setting"}],shape:"circle",shapeOptions:[{label:"圆形",value:"circle"},{label:"矩形",value:"rectangle"},{label:"三角形",value:"triangle"},{label:"星形",value:"star"}]}},mounted(){this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),this.$nextTick(()=>{this.resizeCanvas()}),window.addEventListener("resize",this.resizeCanvas),this.drawing=!1,this.canvas.addEventListener("touchstart",i=>{i.preventDefault(),this.drawing=!0}),this.canvas.addEventListener("touchend",i=>{i.preventDefault(),this.drawing=!1}),this.canvas.addEventListener("touchmove",i=>{i.preventDefault(),this.draw(i)}),this.canvas.addEventListener("mousedown",()=>this.drawing=!0),this.canvas.addEventListener("mouseup",()=>this.drawing=!1),this.canvas.addEventListener("mouseleave",()=>this.drawing=!1),this.canvas.addEventListener("mousemove",this.draw)},beforeDestroy(){window.removeEventListener("resize",this.resizeCanvas)},methods:{resizeCanvas(){const i=this.$refs.container;if(!i)return;const t=i.getBoundingClientRect();this.canvas.width=t.width,this.canvas.height=t.height},draw(i){if(!this.drawing)return;const t=this.canvas.getBoundingClientRect();let l,n;i.touches?(l=i.touches[0].clientX-t.left,n=i.touches[0].clientY-t.top):(l=i.clientX-t.left,n=i.clientY-t.top),this.colorIndex||(this.colorIndex=0),this.colorType=="rainbow"?(this.ctx.fillStyle=this.rainbowColors[this.colorIndex],this.colorIndex=(this.colorIndex+1)%this.rainbowColors.length):this.ctx.fillStyle=this.colorValue,this.ctx.beginPath();let e=this.circleSize/2;this.shape=="circle"?(this.ctx.arc(l,n,this.circleSize/2,0,2*Math.PI*this.angle/1e3),this.ctx.fill()):this.shape=="rectangle"?this.ctx.fillRect(l-e,n-e,this.circleSize,this.circleSize):this.shape=="triangle"?(this.ctx.beginPath(),this.ctx.moveTo(l-.577*this.circleSize,n+e),this.ctx.lineTo(l,n-2*this.circleSize/3),this.ctx.lineTo(l+.577*this.circleSize,n+e),this.ctx.closePath()):this.shape=="star"&&(this.ctx.beginPath(),this.ctx.moveTo(l,n+2*e/2),this.ctx.lineTo(l+.577*e/2,n+e/2),this.ctx.lineTo(l+1.732*e/2,n+e/2),this.ctx.lineTo(l+1.154*e/2,n),this.ctx.lineTo(l+1.732*e/2,n-e/2),this.ctx.lineTo(l+.577*e/2,n-e/2),this.ctx.lineTo(l,n-2*e/2),this.ctx.lineTo(l-.577*e/2,n-e/2),this.ctx.lineTo(l-1.732*e/2,n-e/2),this.ctx.lineTo(l-1.154*e/2,n),this.ctx.lineTo(l-1.732*e/2,n+e/2),this.ctx.lineTo(l-.577*e/2,n+e/2),this.ctx.closePath()),this.ctx.fill()},clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},saveCanvas(){const{canvas:i}=this.$refs;i.toBlob(t=>{const l=document.createElement("a");l.download=`canvas_${Date.now()}.png`,l.href=window.URL.createObjectURL(t),l.click(),console.log(t)},"image/png")},uploadCanvasToOss(){},handleProgressChange(){this.circleSize=10+this.progress/100*90},handleAngleChange(){this.angle=this.angle},getChildData(i){this.colorValue=i},checkShape(i){return i==this.shape}}},V={ref:"container",class:"canvas-container"},L=["value"],P=["value"],E={class:"pen-size"},I={key:0},D={style:{display:"flex"}},U={ref:"canvas",class:"flex-canvas"};function B(i,t,l,n,e,r){const w=v("ColorPicker"),C=v("star");return a(),c("div",V,[k(w,{modelValue:e.colorValue,"onUpdate:modelValue":t[0]||(t[0]=s=>e.colorValue=s),"onUpdate:color":r.getChildData},null,8,["modelValue","onUpdate:color"]),t[10]||(t[10]=o("span",null,"颜色:",-1)),u(o("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>e.colorType=s)},[(a(!0),c(p,null,x(e.options,s=>(a(),c("option",{key:s.value,value:s.value},m(s.label),9,L))),128))],512),[[g,e.colorType]]),t[11]||(t[11]=o("span",null,"画笔:",-1)),u(o("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>e.shape=s)},[(a(!0),c(p,null,x(e.shapeOptions,s=>(a(),c("option",{key:s.value,value:s.value},m(s.label),9,P))),128))],512),[[g,e.shape]]),r.checkShape("circle")?(a(),c("div",{key:0,class:"circle",style:d({width:e.circleSize+"px",height:e.circleSize+"px",backgroundColor:e.colorValue})},null,4)):h("",!0),r.checkShape("rectangle")?(a(),c("div",{key:1,class:"rectangle",style:d({width:e.circleSize+"px",height:e.circleSize+"px",backgroundColor:e.colorValue})},null,4)):h("",!0),r.checkShape("triangle")?(a(),c("div",{key:2,class:"triangle",style:d({"border-left-width":e.circleSize/2+"px","border-right-width":e.circleSize/2+"px","border-bottom-width":e.circleSize+"px","border-bottom-color":e.colorValue})},null,4)):h("",!0),r.checkShape("star")?(a(),z(C,{key:3,color:e.colorValue,size:e.circleSize},null,8,["color","size"])):h("",!0),o("div",E,[t[9]||(t[9]=o("span",null,"大小",-1)),u(o("input",{type:"range",min:"0",max:"100","onUpdate:modelValue":t[3]||(t[3]=s=>e.progress=s),onInput:t[4]||(t[4]=(...s)=>r.handleProgressChange&&r.handleProgressChange(...s)),class:"progress-bar"},null,544),[[f,e.progress]]),r.checkShape("circle")?(a(),c("span",I,"角度")):h("",!0),r.checkShape("circle")?u((a(),c("input",{key:1,type:"range","onUpdate:modelValue":t[5]||(t[5]=s=>e.angle=s),min:"0",max:"1000",onInput:t[6]||(t[6]=(...s)=>r.handleAngleChange&&r.handleAngleChange(...s))},null,544)),[[f,e.angle]]):h("",!0)]),o("div",D,[o("button",{onClick:t[7]||(t[7]=(...s)=>r.clear&&r.clear(...s))},"清除"),o("button",{onClick:t[8]||(t[8]=(...s)=>r.saveCanvas&&r.saveCanvas(...s))},"导出")]),o("canvas",U,null,512)],512)}const M=y(T,[["render",B],["__scopeId","data-v-3f748d59"]]);export{M as default};
