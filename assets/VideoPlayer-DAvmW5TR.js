import{l as v,x as g,m as A,q as D,c as u,o as r,a as n,b as k,g as F,t as h,v as L,F as M,j as N,k as P,f as q}from"./app-w1t-cu3g.js";import{_ as E}from"./plugin-vue_export-helper-DlAUqK2U.js";const O={class:"video-player"},R={class:"video-area"},U=["src","width","height"],j=["src","poster"],z={key:0,class:"controls"},K=["max"],G={class:"time"},H={key:1,class:"playlist"},J=["onClick"],Q=["src"],W={__name:"VideoPlayer",props:{videos:{type:Array,required:!0},width:{type:[Number,String],default:640},height:{type:[Number,String],default:360},autoplayOnSwitch:{type:Boolean,default:!1}},setup(c){const o=c,s=v(null),l=v(!1),d=v(0),m=v(0),i=v(0),b=v(Date.now()),f=g(()=>o.videos[i.value]||{}),p=g(()=>{const e=(f.value.type||"").toLowerCase();return e==="bilibili"||e==="bili"||e==="b"}),S=g(()=>{const e=f.value;if(!e)return"";if(e.src&&e.src.includes("player.bilibili.com")){const y=e.autoplay?"1":"0";return e.src.includes("autoplay=")?e.src:`${e.src}${e.src.includes("?")?"&":"?"}autoplay=${y}`}const a=e.src||e.bvid||e.bv||"",t=e.autoplay?"1":"0";return`https://player.bilibili.com/player.html?bvid=${encodeURIComponent(a)}&autoplay=${t}`}),_=e=>{if(e===i.value){p.value&&(b.value=Date.now());return}i.value=e,d.value=0,m.value=0,l.value=!1,C(e)?b.value=Date.now():setTimeout(()=>{const a=s.value;if(!a)return;(o.autoplayOnSwitch||!!(o.videos[e]&&o.videos[e].autoplay))&&a.play().then(()=>{l.value=!0}).catch(()=>{l.value=!1})},50)},C=e=>{const t=((o.videos[e]||{}).type||"").toLowerCase();return t==="bilibili"||t==="bili"||t==="b"},T=()=>{const e=s.value;e&&(e.paused?e.play().then(()=>{l.value=!0}).catch(()=>{l.value=!1}):(e.pause(),l.value=!1))},V=()=>{const e=s.value;e&&(d.value=e.currentTime)},$=()=>{const e=s.value;e&&(m.value=e.duration||0)},B=()=>{const e=s.value;e&&(e.currentTime=d.value)},I=()=>{i.value<o.videos.length-1?_(i.value+1):l.value=!1},x=()=>{var a,t;const e=p.value?document.querySelector(".iframe-player"):s.value;e&&(document.fullscreenElement?(t=document.exitFullscreen)==null||t.call(document):(a=e.requestFullscreen)==null||a.call(e))},w=e=>{if(!e&&e!==0)return"--:--";const a=Math.floor(e/60),t=Math.floor(e%60);return`${a.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`};return A(()=>o.videos,e=>{!e||e.length===0||i.value>=e.length&&(i.value=0)}),D(()=>{const e=f.value;e&&!p.value&&(o.autoplayOnSwitch||e.autoplay)&&setTimeout(()=>{const t=s.value;t&&t.play().then(()=>{l.value=!0}).catch(()=>{l.value=!1})},50)}),(e,a)=>(r(),u("div",O,[n("div",R,[p.value?(r(),u("iframe",{key:b.value,class:"iframe-player",src:S.value,scrolling:"no",frameborder:"0",allowfullscreen:"true",width:c.width,height:c.height},null,8,U)):(r(),u("video",{key:1,ref_key:"videoRef",ref:s,class:"video",src:f.value.src,poster:f.value.poster,controlslist:"nodownload",onTimeupdate:V,onLoadedmetadata:$,onEnded:I},null,40,j))]),p.value?k("",!0):(r(),u("div",z,[n("button",{onClick:T},h(l.value?"暂停":"播放"),1),F(n("input",{type:"range",min:"0",max:m.value||0,step:"0.1","onUpdate:modelValue":a[0]||(a[0]=t=>d.value=t),onInput:B},null,40,K),[[L,d.value,void 0,{number:!0}]]),n("span",G,h(w(d.value))+" / "+h(w(m.value)),1),n("button",{onClick:x}," 全屏 ")])),c.videos&&c.videos.length>1?(r(),u("div",H,[a[1]||(a[1]=n("h4",null,"播放列表",-1)),n("ul",null,[(r(!0),u(M,null,N(c.videos,(t,y)=>(r(),u("li",{key:y,class:P({active:y===i.value}),onClick:X=>_(y)},[n("img",{src:t.pic},null,8,Q),q(" "+h(t.title||(t.type==="bilibili"?"Bilibili 视频":"视频")),1)],10,J))),128))])])):k("",!0)]))}},ee=E(W,[["__scopeId","data-v-fb2a4b0e"]]);export{ee as default};
